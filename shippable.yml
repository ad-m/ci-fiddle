language: node_js
dist: xenial

node_js:
  - '12.8.0'

env:
  global:
    - TEST_RESULTS_DIR=$SHIPPABLE_REPO_DIR/shippable/testresults

build:
  ci:
    - node --version
    - npm --version
    - npm install
    - npm build
    - npm run test
    - mkdir -p $TEST_RESULTS_DIR
    - JEST_JUNIT_OUTPUT="${TEST_RESULTS_DIR}/testresults.xml" npm run test:ci

integrations:
  notifications:
    - integrationName: email
      type: email
      recipients:
        - "--last_committer"
        - "--last_author"
      sendConsoleLogs: true
      on_success: never
      on_failure: never
      on_cancel: never
      on_start: never
      on_pull_request: never
