language: none

build:
  pre_ci_boot:
    image_name: vidavidorra/linux-cmake
    image_tag: ubuntu1404-develop
    pull: true

  ci:
    - echo $NVM_DIR
    - ls -la /usr/local/bin
    - cat /root/1a65bc0a-fbf2-4905-9473-777398663315.sh
    - pwd
    - echo ${CMAKE_BASE_PATH}
    - echo $0
    - cat ~/.bashrc
    - . ~/.bashrc && echo ${CMAKE_BASE_PATH} && echo "${CMAKE_VERSIONS[@]}"
    - echo ${CMAKE_BASE_PATH}
    - echo $NVM_DIR
    - ls -la /linux-cmake/
    - cmake --version
    - echo "${CMAKE_VERSIONS[@]}"
    - cat /linux-cmake/cmake/versions
    - chmod +x /linux-cmake/cmake/versions
    - . /linux-cmake/cmake/versions
    - echo "${CMAKE_VERSIONS[@]}"
    - cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bcmake-build-release -H./examples/regression_test
    - >
      for version in "${CMAKE_VERSIONS[@]}"; do
        echo "Testing CMake v${version}"
        echo "${CMAKE_BASE_PATH}-${version}" -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bcmake-build-release -H./examples/regression_test
      done;

integrations:
  notifications:
    - integrationName: email
      type: email
      recipients:
        --last_committer
        --last_author
      on_success: change
      on_failure: change
      on_cancel: never
      on_start: never
      on_pull_request: never
